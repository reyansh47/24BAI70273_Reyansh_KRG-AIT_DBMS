  CREATE TABLE EMPLOYEE (
      emp_id NUMERIC(10,0) PRIMARY KEY,
      emp_name VARCHAR(50),
      department VARCHAR(30),
      salary NUMERIC(10,0),
      joining_date DATE
  );


  INSERT INTO EMPLOYEE VALUES (1, 'Aman', 'IT', 55000, '2022-01-10');
  INSERT INTO EMPLOYEE VALUES (2, 'Rohit', 'IT', 48000, '2021-07-15');
  INSERT INTO EMPLOYEE VALUES (3, 'Neha', 'IT', 62000, '2020-03-20');
  INSERT INTO EMPLOYEE VALUES (4, 'Simran', 'HR', 53000, '2021-11-05');
  INSERT INTO EMPLOYEE VALUES (5, 'Karan', 'HR', 45000, '2022-06-18');			
  



-- COUNT NUMBER OF EMPLOYEES IN EACH DEPARTMENT

-- (I)
SELECT DEPARTMENT ,COUNT(*) AS COUNT_EMPLOYEES
FROM EMPLOYEE
GROUP BY DEPARTMENT
-- (II)

SELECT DEPARTMENT ,COUNT(EMP_ID) AS COUNT_EMPLOYEES
FROM EMPLOYEE
GROUP BY DEPARTMENT


--- SORT ON THE BASIS OF COUNT OF EMPLOYEES IN EACH DEPARTMENT

SELECT DEPARTMENT ,COUNT(EMP_ID) AS COUNT_EMPLOYEES
FROM EMPLOYEE
GROUP BY DEPARTMENT
ORDER BY COUNT_EMPLOYEES ASC


SELECT DEPARTMENT ,COUNT(*) AS COUNT_EMPLOYEES
FROM EMPLOYEE
GROUP BY DEPARTMENT
ORDER BY COUNT(*) ASC



SELECT DEPARTMENT ,COUNT(EMP_ID) AS COUNT_EMPLOYEES
FROM EMPLOYEE
GROUP BY DEPARTMENT
HAVING COUNT(EMP_ID)>=3


-- FIND AVERAGE SALARY OF EACH DEPARTMENT


SELECT DEPARTMENT ,AVG(SALARY)::NUMERIC(10,2) AS AVERAGE_SALARY
FROM EMPLOYEE
GROUP BY DEPARTMENT

--SUM,MIN,MAX

select department, sum(salary):: numeric(10,2) as average_sum
from employee
group by department

select department, min(salary):: numeric(10,2) as average_min
from employee
group by department

select department, max(salary):: numeric(10,2) as average_max
from employee
group by department
